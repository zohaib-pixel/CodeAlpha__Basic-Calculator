<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Basic Calculator</title>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #7c3aed;
      --muted: #94a3b8;
      --glass: rgba(255,255,255,0.04);
      --btn: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    * { box-sizing: border-box; }
    html,body { height:100%; margin:0; background: radial-gradient(1200px 600px at 10% 10%, rgba(124,58,237,0.08), transparent), var(--bg); color:#e6eef8; }

    .wrap {
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
    }

    .calculator {
      width:360px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:18px;
      padding:18px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
    }

    .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
    .title { font-weight:600; letter-spacing:0.2px; }
    .sub { color:var(--muted); font-size:13px; }

    .screen {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:14px;
      min-height:86px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
      margin-bottom:14px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .preview {
      font-size:14px;
      color:var(--muted);
      text-align:right;
      min-height:18px;
      overflow:hidden;
      white-space:nowrap;
      text-overflow:ellipsis;
    }

    .display {
      font-size:28px;
      font-weight:600;
      text-align:right;
      word-break:break-all;
    }

    .keys {
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }

    button.key {
      padding:14px 12px;
      border-radius:10px;
      font-size:18px;
      background: var(--btn);
      border:1px solid rgba(255,255,255,0.03);
      cursor:pointer;
      user-select:none;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.12s;
      box-shadow: 0 4px 10px rgba(2,6,23,0.45);
    }

    button.key:active { transform: translateY(2px) scale(0.998); }
    button.key:focus { outline: 2px solid rgba(124,58,237,0.16); }

    button.op {
      background: linear-gradient(180deg, rgba(124,58,237,0.18), rgba(124,58,237,0.12));
      color: white;
      font-weight:600;
    }

    button.equal {
      grid-column: span 2;
      background: linear-gradient(180deg, rgba(34,197,94,0.18), rgba(16,185,129,0.12));
      color: #042f21;
      font-weight:700;
    }

    button.wide { grid-column: span 2; }

    .muted { color:var(--muted); font-size:13px; text-align:center; margin-top:10px; }

    @media (max-width:420px){
      .calculator{ width:100%; }
      .display{ font-size:24px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <main class="calculator" role="application" aria-label="Calculator">
      <div class="header">
        <div>
          <div class="title">Calculator</div>
          <div class="sub">Basic arithmetic • Keyboard & touch</div>
        </div>
        <div class="sub">Press Enter =</div>
      </div>

      <div class="screen" aria-live="polite">
        <div id="preview" class="preview" aria-hidden="true"></div>
        <div id="display" class="display" aria-label="Calculator display">0</div>
      </div>

      <div class="keys" role="group" aria-label="Calculator keys">
        <button class="key op" data-action="clear" aria-label="Clear (Escape)">C</button>
        <button class="key op" data-action="back" aria-label="Backspace (Backspace)">⌫</button>
        <button class="key" data-value="(" aria-label="Open parenthesis">(</button>
        <button class="key" data-value=")" aria-label="Close parenthesis">)</button>

        <button class="key" data-value="7">7</button>
        <button class="key" data-value="8">8</button>
        <button class="key" data-value="9">9</button>
        <button class="key op" data-value="/" aria-label="Divide">÷</button>

        <button class="key" data-value="4">4</button>
        <button class="key" data-value="5">5</button>
        <button class="key" data-value="6">6</button>
        <button class="key op" data-value="*" aria-label="Multiply">×</button>

        <button class="key" data-value="1">1</button>
        <button class="key" data-value="2">2</button>
        <button class="key" data-value="3">3</button>
        <button class="key op" data-value="-" aria-label="Minus">−</button>

        <button class="key wide" data-value="0">0</button>
        <button class="key" data-value=".">.</button>
        <button class="key op" data-value="+" aria-label="Plus">+</button>

        <button class="key equal" data-action="equals" aria-label="Equals (Enter)">=</button>
      </div>

      <div class="muted">Keyboard: numbers, +-*/ . Enter =, Backspace to delete, Esc/C to clear</div>
    </main>
  </div>

  <script>
    (function(){
      const displayEl = document.getElementById('display');
      const previewEl = document.getElementById('preview');
      const keys = document.querySelectorAll('.key');

      let expr = '';

      function safeEval(expression) {
        // Map display-friendly operators to JS ones
        const sanitized = expression.replace(/×/g, '*').replace(/÷/g, '/').replace(/−/g,'-');
        // Allow digits, operators, parentheses, decimal point and whitespace only
        if (!/^[0-9+\-*/().\s]+$/.test(sanitized)) return { ok:false };
        try {
          // Use Function to evaluate, but already restricted by regex
          const result = Function('return (' + sanitized + ')')();
          if (typeof result === 'number' && isFinite(result)) return { ok:true, value: result };
        } catch(e){ }
        return { ok:false };
      }

      function updateDisplay(){
        displayEl.textContent = expr || '0';
        const r = safeEval(expr);
        previewEl.textContent = r.ok ? (r.value === Math.round(r.value) ? r.value : r.value.toPrecision(12).replace(/(?:\.0+|0+)$/,'') ) : '';
      }

      function appendToExpr(s){
        // Prevent multiple dots in same number segment
        if (s === '.'){
          // find last operator
          const last = expr.split(/[+\-*/()]/).pop();
          if (last.includes('.')) return; // ignore
          if (last === '' ) s = '0.';
        }

        // Avoid leading zeros like 00
        if (/^0$/.test(expr) && /[0-9]/.test(s)){
          expr = s;
        } else {
          expr += s;
        }

        updateDisplay();
      }

      function clearAll(){ expr = ''; updateDisplay(); }
      function backspace(){ expr = expr.slice(0, -1); updateDisplay(); }

      keys.forEach(k => {
        k.addEventListener('click', (e) => {
          const action = k.dataset.action;
          const value = k.dataset.value;
          if (action === 'clear') return clearAll();
          if (action === 'back') return backspace();
          if (action === 'equals') return doEquals();
          if (typeof value !== 'undefined') return appendToExpr(value);
        });
      });

      function doEquals(){
        const r = safeEval(expr);
        if (r.ok){
          // format small floats nicely
          const v = (r.value === Math.round(r.value)) ? r.value : Number.parseFloat(r.value.toPrecision(12));
          expr = String(v);
          updateDisplay();
        } else {
          // show brief error
          displayEl.textContent = 'Error';
          previewEl.textContent = '';
          setTimeout(() => updateDisplay(), 700);
        }
      }

      // Keyboard support
      window.addEventListener('keydown', (ev) => {
        // ignore when modifiers used (except shift for *)
        if (ev.metaKey || ev.ctrlKey) return;
        const key = ev.key;
        if (/^[0-9]$/.test(key)) { appendToExpr(key); ev.preventDefault(); return; }
        if (key === '.') { appendToExpr('.'); ev.preventDefault(); return; }
        if (key === '+') { appendToExpr('+'); ev.preventDefault(); return; }
        if (key === '-') { appendToExpr('-'); ev.preventDefault(); return; }
        if (key === '*' || (key === 'x' || key === 'X')) { appendToExpr('*'); ev.preventDefault(); return; }
        if (key === '/') { appendToExpr('/'); ev.preventDefault(); return; }
        if (key === 'Enter') { doEquals(); ev.preventDefault(); return; }
        if (key === 'Backspace') { backspace(); ev.preventDefault(); return; }
        if (key === 'Escape' || key.toLowerCase() === 'c') { clearAll(); ev.preventDefault(); return; }
        if (key === '(' || key === ')') { appendToExpr(key); ev.preventDefault(); return; }
      });

      // Allow clicking on the screen to focus for keyboard hints (not an input element)
      document.querySelector('.calculator').addEventListener('click', () => {
        // small visual focus cue
        document.querySelectorAll('.key:focus').forEach(el => el.blur());
      });

      // initialize
      updateDisplay();

      // small UX: support paste of expression
      window.addEventListener('paste', (e) => {
        const text = (e.clipboardData || window.clipboardData).getData('text');
        if (!text) return;
        // accept only allowed chars
        if (/^[0-9+\-*/().\s]+$/.test(text)){
          expr += text.trim();
          updateDisplay();
          e.preventDefault();
        }
      });

    })();
  </script>
</body>
</html>
